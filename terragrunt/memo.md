## required_versionsについて

- terragruntで直接terragrunt.hclのsourceにmoduleを使うときに、`Duplicate required providers configuration`が出る。
- 一般的にterraformでは、module側にもrequired_providersを入れる必要がある
- sourceにmodulesのdirを指定し、そのdirの中でmoduleを使えば問題ないかもしれない

> おわかりのように、Terraformは各モジュールに必要なプロバイダの定義が1つしかないことを想定しています。これは、宣言が複数のファイルにまたがっている場合に、なぜTerraformが特定のものを検知しているのかが不明確になる事態を避けるためのものです。
しかし、このような断片的なコード生成のユースケースをサポートするために、TerraformにはOverride Filesと呼ばれる高度な機能があり、特定のファイルを明示的にマークすることで、全く新しい定義を作成するのではなく、他のファイルから特定の定義を選択的に上書きするような別の処理モードにすることができます。
この仕組みの詳細はオーバーライドするブロックの種類によって異なりますが、terraformブロックのマージ`のセクションで特定の状況に関連する動作について説明します：

> > required_providers引数が設定されている場合、その値は要素ごとにマージされます。これにより、オーバーライド・ブロックは、他のプロバイダの制約に影響を与えることなく、1つのプロバイダの制約を調整することができます。
required_versionとrequired_providersの両方の設定において、各オーバーライド制約は、元のブロック内の同じコンポーネントの制約を完全に置き換えます。ベース・ブロックとオーバーライド・ブロックの両方がrequired_versionを設定している場合、ベース・ブロックの制約は完全に無視されます。

> 上記の実用的な意味は、AWSプロバイダのエントリを含むrequired_providersブロックを持つオーバーライドファイルがある場合、Terraformは非オーバーライドファイルに既に存在する同様のエントリの完全な置き換えとしてそれを扱いますが、オーバーライドファイルに全く現れない他のプロバイダ要件エントリには影響しないということです。
これらをまとめると、Terragruntにこの生成ファイルの名前をprovider.tfではなくprovider_override.tfにするように依頼することで求めていた結果を得ることができるはずです。これにより、オーバーライドファイルの処理動作が有効になり、この生成ファイルが既存のAWSプロバイダ要件の定義をオーバーライドできるようになります。

ref: https://stackoverflow.com/questions/66770564/using-terragrunt-generate-provider-block-causes-conflicts-with-require-providers
